---
id: linux
title: Installation for Linux
sidebar_label: Linux
slug: /installation/linux
description: A tutorial about the installation or compilation of the package for Linux.
---

import DarkButton from '@site/src/components/DarkButton';
import IconExternalLink from '@theme/IconExternalLink';
import InlineIcon from '@site/src/components/InlineIcon';
import mdiDownloadBox from '@iconify-icons/mdi/download-box';
import vsiDebugAlt from '@iconify-icons/codicon/debug-alt';
import vsiCheckIcon from '@iconify-icons/codicon/check';
import vsiCloseIcon from '@iconify-icons/codicon/close';
import octMarkGithub16 from '@iconify-icons/octicon/mark-github-16';


This guide contains steps for installing or compiling the `mpegCoder` module manually. We recommend users who need to use `mpegCoder` in a project locally to install the package by this way.

## Install the pre-compiled module {#install-the-pre-compiled-module}

### Download `mpegCoder` {#download-mpegcoder}

First, users need to download the single module. We provide the downloading links in the following table. Please check the correct version according to your environment.

| mpegCoder | FFMpeg | Numpy | Python | GCC/G++ | OS |
| :-----: | :-----: | :-----: | :-----: | :-----: | :-----: |
| [`3.2.0`<InlineIcon icon={mdiDownloadBox}/>][download-3-2-0-py310] | `5.0` | `1.22.3` | `3.10.4` | `10.2.1` | `Debian 11` |
| [`3.2.0`<InlineIcon icon={mdiDownloadBox}/>][download-3-2-0-py39]  | `5.0` | `1.22.3` | `3.9.12` | `10.2.1` | `Debian 11` |
| [`3.2.0`<InlineIcon icon={mdiDownloadBox}/>][download-3-2-0-py38]  | `5.0` | `1.22.3` | `3.8.13` | `10.2.1` | `Debian 11` |
| [`3.2.0`<InlineIcon icon={mdiDownloadBox}/>][download-3-2-0-py37]  | `5.0` | `1.21.5` | `3.7.13` | `10.2.1` | `Debian 11` |
| [`3.2.0`<InlineIcon icon={mdiDownloadBox}/>][download-3-2-0-py36]  | `5.0` | `1.19.5` | `3.6.15` | `10.2.1` | `Debian 11` |

After extracting the tarball, we could get `mpegCoder.so`.

:::info

Note that the above versions only show the environment when building `mpegCoder`. It does not mean that they are the dependencies of running `mpegCoder`. For example, users could use `python 3.9.5` and `numpy 1.22.0` to run `mpegCoder`.

:::

### Install Numpy {#install-numpy}

To run `mpegCoder`, you are required to install [Numpy<IconExternalLink/>][link-numpy] with the correct version first. The best version for each `mpegCoder` release has been listed before. If your Numpy version is differnt from the best version too much, `mpegCoder` may not work. Here is the command for installation.

```shell
python -m pip install numpy==<version>
```

### Download dependencies {#download-dependencies}

The pre-compiled dependencies are available on our release page. The dependencies contain several `.so` files. Users also need to download the tarball with the correct FFMpeg version, and extract the files.

| FFMpeg | GCC/G++ | OS |
| :-----: | :-----: | :-----: |
| [`5.0`<InlineIcon icon={mdiDownloadBox}/>][download-ff-5-0] | `10.2.1` | Debian `11` |

These files are compiled by myself, because FFMpeg has not released the fully built shared libraries for Linux. To learn how to compile the FFMpeg, please check [the compilation section](#compile-the-module).

### Import {#import}

Running the pre-compiled `mpegCoder` requires users to add the required dynamic libraries to your library path. The extracted dependency files should contain two folders:

```shell
.
|---lib
`---lib-fix
```

We recommend users to place the two folders in a global domain, for example,

```shell
/opt/ffmpeg/
|---lib
`---lib-fix
```

After that, users could add the following lines to your `~/.bashrc`

```shell
export LD_LIBRARY_PATH=/opt/ffmpeg/lib:$LD_LIBRARY_PATH
export PKG_CONFIG_PATH=/opt/ffmpeg/lib/pkgconfig:$PKG_CONFIG_PATH
export PKG_CONFIG_LIBDIR=/opt/ffmpeg/lib/:$PKG_CONFIG_LIBDIR
```

To make the configurations take effects instantly, please run

```shell
source ~/.bashrc
```

Running the module requires users to install `glibc>=2.29`. Please check the following table and find whether the requirements are fulfilled in your case:

| OS | GLibC | Fulfilled |
| :-----: | :-----: | :-----: |
| Ubuntu bionic (`18.04`) | `2.27` | <InlineIcon icon={vsiCloseIcon}/> |
| Ubuntu focal (`20.04`) | `2.31` | <InlineIcon icon={vsiCheckIcon}/> |
| Debian buster (`10`) | `2.28` | <InlineIcon icon={vsiCloseIcon}/> |
| Debian bullseye (`11`) | `2.31` | <InlineIcon icon={vsiCheckIcon}/> |

If the `glibc>=2.29` is not provided by your OS, we recommend users to compile and install GLibC by themselves. However, if users want a faster hotfix. Please check the extracted dependencies.

Take the above steps as an example, then users could link the provided GLibC to your `/lib` folder.

```shell
ln -sf /opt/ffmpeg/lib-fix/libm-2.31.so /lib/x86_64-linux-gnu/libm.so.6
```

After all, users could place `mpegCoder.so` in your project folder, and import the module by

```python
import mpegCoder
```

## Compile the module {#compile-the-module}

### Compile `mpegCoder` {#compile-mpegcoder}

If users need to compile the module by themselves, please follow the instructions on Github:

<p>
  <DarkButton to="https://github.com/cainmagi/FFmpeg-Encoder-Decoder-for-Python/blob/master-linux/README.md" icon={vsiDebugAlt}>
    Compile with GCC/G++
  </DarkButton>
</p>

### Compile FFMpeg {#compile-ffmpeg}

:::info

Users are not required for compiling FFMpeg by themselves, because `mpegCoder` could be compiled with our provided pre-compiled FFMpeg. But in some cases, user may need to built `mpegCoder` with a specified FFMpeg version.

If users are using their own FFMpeg to compile `mpegCoder`, please check the [configuration<IconExternalLink/>][code-config] in the setup file and the [macros<IconExternalLink/>][code-macros] in the source codes.

:::

We have provided some scripts for compiling FFMpeg. Please check the following branch:

<p>
  <DarkButton to="https://github.com/cainmagi/FFmpeg-Encoder-Decoder-for-Python/tree/deps" icon={octMarkGithub16}>
    Scripts for compilation
  </DarkButton>
</p>

For example, if users want to compile FFMpeg `5.0`, they could run

```shell
curl -O https://raw.githubusercontent.com/cainmagi/FFmpeg-Encoder-Decoder-for-Python/deps/install-ffmpeg-5_0.sh
chmod +rwx install-ffmpeg-5_0.sh
./install-ffmpeg-5_0.sh --all --nvcuda
```

:::info

Note that users may need to modify the scripts according to their own cases. Our script has been only and successfully tested on `Ubuntu 22.04`+`GCC 11.2.0` and `Debian 11`+`GCC 10.2.1`.

:::

[download-3-2-0-py310]:https://github.com/cainmagi/FFmpeg-Encoder-Decoder-for-Python/releases/download/3.2.0-linux/mpegCoder_3_2_0_Linux_py310.tar.xz
[download-3-2-0-py39]:https://github.com/cainmagi/FFmpeg-Encoder-Decoder-for-Python/releases/download/3.2.0-linux/mpegCoder_3_2_0_Linux_py39.tar.xz
[download-3-2-0-py38]:https://github.com/cainmagi/FFmpeg-Encoder-Decoder-for-Python/releases/download/3.2.0-linux/mpegCoder_3_2_0_Linux_py38.tar.xz
[download-3-2-0-py37]:https://github.com/cainmagi/FFmpeg-Encoder-Decoder-for-Python/releases/download/3.2.0-linux/mpegCoder_3_2_0_Linux_py37.tar.xz
[download-3-2-0-py36]:https://github.com/cainmagi/FFmpeg-Encoder-Decoder-for-Python/releases/download/3.2.0-linux/mpegCoder_3_2_0_Linux_py36.tar.xz
[download-ff-5-0]:https://github.com/cainmagi/FFmpeg-Encoder-Decoder-for-Python/releases/download/deps-3.2.0/so-linux-ffmpeg_5_0.tar.xz
[code-config]:https://github.com/cainmagi/FFmpeg-Encoder-Decoder-for-Python/blob/master-linux/setup.py#L34
[code-macros]:https://github.com/cainmagi/FFmpeg-Encoder-Decoder-for-Python/blob/master-linux/MpegCoder/MpegBase.h#L11
[link-numpy]:https://numpy.org "Numpy"
